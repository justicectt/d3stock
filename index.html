<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Insert title here</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/6.2.0/d3.min.js"></script>
<script src="./js/basicdata.js"></script>
<style>
circle {
  fill: cadetblue;
}
line {
  stroke: #ccc;
}
text {
  text-anchor: middle;
  font-family: "Helvetica Neue", Helvetica, sans-serif;
  fill: #666;
  font-size: 16px;
}


</style>
</head>
<body>
<div id="content">
  <svg width="800" height="800">
    <g class="links"></g>
    <g class="nodes"></g>
  </svg>
</div>

<script>
var width = 400, height = 300
/*
var nodes = [
	{id:'01',name: 'A'},
	{id:'02',name: 'B'},
	{id:'03',name: 'C'},
	{id:'04',name: 'D'},
	{id:'05',name: 'E'},
	{id:'06',name: 'F'},
	{id:'07',name: 'G'},
	{id:'08',name: 'H'},
]
*/
var nodes = [
	{'id':'01','name':'水泥工業','nodetype':'industry'},
	{'id':'02','name':'食品工業','nodetype':'industry'},
	{'id':'03','name':'塑膠工業','nodetype':'industry'},
	{'id':'04','name':'紡織纖維','nodetype':'industry'},
	{'id':'05','name':'電機機械','nodetype':'industry'},
	{'id':'06','name':'電器電纜','nodetype':'industry'},
	{'id':'08','name':'玻璃陶瓷','nodetype':'industry'},
	{'id':'09','name':'造紙工業','nodetype':'industry'},
	{'id':'10','name':'鋼鐵工業','nodetype':'industry'},
	{'id':'11','name':'橡膠工業','nodetype':'industry'},
	{'id':'12','name':'汽車工業','nodetype':'industry'},
	{'id':'14','name':'建材營造','nodetype':'industry'},
	{'id':'15','name':'航運業','nodetype':'industry'},
	{'id':'16','name':'觀光事業','nodetype':'industry'},
	{'id':'17','name':'金融業','nodetype':'industry'},
	{'id':'18','name':'貿易百貨','nodetype':'industry'},
	{'id':'19','name':'綜合','nodetype':'industry'},
	{'id':'20','name':'其他','nodetype':'industry'},
	{'id':'21','name':'化學工業','nodetype':'industry'},
	{'id':'22','name':'生技醫療業','nodetype':'industry'},
	{'id':'23','name':'油電燃氣業','nodetype':'industry'},
	{'id':'24','name':'半導體業','nodetype':'industry'},
	{'id':'25','name':'電腦及週邊設備業','nodetype':'industry'},
	{'id':'26','name':'光電業','nodetype':'industry'},
	{'id':'27','name':'通信網路業','nodetype':'industry'},
	{'id':'28','name':'電子零組件業','nodetype':'industry'},
	{'id':'29','name':'電子通路業','nodetype':'industry'},
	{'id':'30','name':'資訊服務業','nodetype':'industry'},
	{'id':'31','name':'其他電子業','nodetype':'industry'},
	{'id':'32','name':'文化創意業','nodetype':'industry'},
	{'id':'33','name':'農業科技業','nodetype':'industry'},
	{'id':'34','name':'電子商務','nodetype':'industry'},
	{'id':'80','name':'管理股票','nodetype':'industry'}
]
var links = [
	{'source':'01','traget':'02'},
	{'source':'02','traget':'03'},
	{'source':'03','traget':'04'},
	{'source':'04','traget':'05'},
	{'source':'05','traget':'06'},
	{'source':'06','traget':'08'},
	{'source':'08','traget':'09'},
	{'source':'09','traget':'10'},
	{'source':'10','traget':'11'},
	{'source':'11','traget':'12'},
	{'source':'12','traget':'14'},
	{'source':'14','traget':'15'},
	{'source':'15','traget':'16'},
	{'source':'16','traget':'17'},
	{'source':'17','traget':'18'},
	{'source':'18','traget':'19'},
	{'source':'19','traget':'20'},
	{'source':'20','traget':'21'},
	{'source':'21','traget':'22'},
	{'source':'22','traget':'23'},
	{'source':'23','traget':'24'},
	{'source':'24','traget':'25'},
	{'source':'25','traget':'26'},
	{'source':'26','traget':'27'},
	{'source':'27','traget':'28'},
	{'source':'28','traget':'29'},
	{'source':'29','traget':'30'},
	{'source':'30','traget':'31'},
	{'source':'31','traget':'32'},
	{'source':'32','traget':'33'},
	{'source':'33','traget':'34'},
	{'source':'34','traget':'80'},
	{'source':'80','traget':'01'}
]

var simulation = d3.forceSimulation(nodes)
	.force('charge', d3.forceManyBody().strength(-100))
	.force('center', d3.forceCenter(width / 2, height / 2))
	.force('link', d3.forceLink().links(links).id(d => d.id))
	.on('tick', ticked);

function updateLinks() {
	var u = d3.select('.links')
		.selectAll('line')
		.data(links)
		.join('line')
		.attr('x1', function(d) {
			return d.source.x
		})
		.attr('y1', function(d) {
			return d.source.y
		})
		.attr('x2', function(d) {
			return d.target.x
		})
		.attr('y2', function(d) {
			return d.target.y
		});
}

function updateNodes() {
	u = d3.select('.nodes')
		.selectAll('text')
		.data(nodes)
		.join('text')
		.text(function(d) {
			return d.name
		})
		.attr('x', function(d) {
			return d.x
		})
		.attr('y', function(d) {
			return d.y
		})
		.attr('dy', function(d) {
			return 5
		});
}

function ticked() {
	updateLinks()
	updateNodes()
}


</script>
</body>
</html>